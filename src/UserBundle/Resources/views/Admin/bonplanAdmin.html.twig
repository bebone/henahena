{% extends "::layout.html.twig" %}
{% block titre %}
    {{ parent() }} Administration
{% endblock %}
{% block contenu %}

    <h1><span class=""></span> Bons Plans </h1>


    <ul class="nav nav-tabs">
        <li class="active"><a href="#bonplan" data-toggle="tab">Bons plans ajoutés</a></li>
        <li class=""><a aria-expanded="false" href="#ajoutbonplan" data-toggle="tab"> <span class="fa fa-plus"></span> Ajouter un bon plan</a></li>

    </ul>
    <div id="myTabContent" class="tab-content">
        <div class="tab-pane fade active in" id="bonplan">
            <table class="table ">
                <thead>
                <tr>
                    <th>Nom</th>
                    <th>Catégorie</th>
                    <th>Dernière modification</th>
                    <th>Actions</th>
                </tr>
                </thead>
                <tbody>
                {% for bonplan in bonsplans %}
                    <tr>
                        <td><a href="{{ path('bonplan_view',{'id':bonplan.id}) }}">{{ bonplan.titre }}</a></td>
                        <td>{{ bonplan.categorie.nom }}</td>
                        <td>{{ bonplan.dateModif | date("d/m/Y à H:i") }}</td>
                        <td><a href="{{ path('bonplan_edit',{'id':bonplan.id}) }}"
                               class="btn btn-primary">Modifier</a>
                            <a href="{{ path('bonplan_delete', {'id':bonplan.id}) }}" class="btn btn-danger"
                               onclick="return confirm('Supprimer??')"><span class="fa fa-trash"></span></a></td>

                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="tab-pane fade" id="ajoutbonplan">
            <form action="{{ path("bonsplans_create") }}" method="post" {{ form_enctype(form) }}>


                <div>
                    {{ form_errors(form.titre) }}
                    {{ form_label(form.titre) }}
                    {{ form_widget(form.titre) }}
                </div>
                <div>
                    {{ form_errors(form.categorie) }}
                    {{ form_label(form.categorie) }}
                    {{ form_widget(form.categorie) }}
                </div>
                <div>
                    {{ form_errors(form.contenu) }}
                    {{ form_label(form.contenu) }}
                    {{ form_widget(form.contenu) }}
                </div>

                <div style="display:none" class="colocation">
                    {{ form_errors(form.superficie) }}
                    {{ form_label(form.superficie) }}
                    {{ form_widget(form.superficie) }}
                </div>

                <div style="display:none" class="colocation">
                    {{ form_errors(form.loyer) }}
                    {{ form_label(form.loyer) }}
                    {{ form_widget(form.loyer) }}
                </div>

                <div style="display:none" class="covoiturage">
                    {{ form_errors(form.prix) }}
                    {{ form_label(form.prix) }}
                    {{ form_widget(form.prix) }}
                </div>

                <div style="display:none" class="covoiturage">
                    {{ form_errors(form.depart) }}
                    {{ form_label(form.depart) }}
                    {{ form_widget(form.depart) }}
                </div>

                <div style="display:none" class="covoiturage">
                    {{ form_errors(form.arrivee) }}
                    {{ form_label(form.arrivee) }}
                    {{ form_widget(form.arrivee) }}
                </div>


                {{ form_rest(form) }}
                <input type="submit" id="submit" value="VALIDER" name="submit"/>
            </form>
            <p>{{ parent() }}</p>

        </div>
    </div>

{% endblock %}
{% block scripts %}
    {{ parent() }}
    <script src="{{ asset('bundles/app/ckeditor/ckeditor.js') }}"></script>
    <script>

        CKEDITOR.replace('bonplan_create[contenu]');

        $('#bonplan_create_categorie').on('change', (function () {

            // alert('toto');
            if ($('#bonplan_create_categorie option:selected').val() == 1) {
                $(".covoiturage").fadeIn("slow");
                $(".colocation").fadeOut("slow");

            }
            else if ($('#bonplan_create_categorie option:selected').val() == 2) {
                $(".covoiturage").fadeOut("slow");
                $(".colocation").fadeIn("slow");
            }
            else {
                $(".covoiturage").fadeOut("slow");
                $(".colocation").fadeOut("slow");
            }
        }));

    </script>
{% endblock %}